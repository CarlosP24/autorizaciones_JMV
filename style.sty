% style.sty - project style package
\ProvidesPackage{style}[2025/12/17 Custom project style]

% Page layout
\RequirePackage[paper=a4paper,top=0.4in,bottom=1in,left=1in,right=1in,includeheadfoot]{geometry}

% Fonts
\RequirePackage{fontspec}
\setmainfont{Arial}
\newfontfamily\ImpactFont{Impact}[BoldFont={Impact}]
% Language: use polyglossia for Xe/Lua engines and set Spanish as the main language
\RequirePackage{polyglossia}
\setdefaultlanguage{spanish}

% Graphics & layout
\RequirePackage{graphicx}
\RequirePackage{tabularx}
\RequirePackage{array}
\RequirePackage{xcolor}
\RequirePackage{lastpage}
\RequirePackage{tabularx}
\RequirePackage{tikz}
\RequirePackage{setspace}
\RequirePackage{pbox}

% Color definitions
\definecolor{headercolor}{HTML}{AF6528}
\definecolor{headerlowercolor}{HTML}{4D527E}

% Header / Footer
\RequirePackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{} % clear header/footer

% Defaults (empty): documents should set these with \renewcommand
\providecommand{\headerleftlineone}{}
\providecommand{\headerleftlinetwo}{}
\providecommand{\headerrightline}{}
\providecommand{\headerlogo}{}
% Provide a default list of centers for the dropdown; documents can \renewcommand this in their preamble
\providecommand{\centeroptions}{La Inmaculada-Marillac, La Milagrosa (Carabanchel), Santa Isabel, San Vicente de Paúl, San Matías, La Inmaculada (Leganés), San José (Valdemoro), Nuestra Señora del Carmen (Móstoles), San Juan Bautista (Tavera)  (Toledo), Nuestra Señora de los Desamparados (Noblejas)}

% Header: left block with logo + two lines, right block with one right-aligned line
\fancyhead[L]{%
  \begin{tabularx}{0.6\textwidth}{@{} >{\centering\arraybackslash}m{60pt} @{\hspace{8pt}} X @{} }
    \headerlogo & {\raggedright\ImpactFont\fontsize{24}{24}\textcolor{headercolor}{\headerleftlineone} \\
      \textcolor{headerlowercolor}{\headerleftlinetwo}} \\
  \end{tabularx}
}

\fancyhead[R]{%
  \parbox[c][60pt][c]{0.35\textwidth}{\raggedleft\small\headerrightline}
}

% Header/footer spacing
\setlength{\headsep}{10pt}
\setlength{\headheight}{70pt}
\setlength{\footskip}{36pt}

% Footer: three columns, vertically centered
\cfoot{\parbox[c][36pt][c]{0.33\textwidth}{\centering P\'agina \thepage\ de \pageref{LastPage}}}

% Remove horizontal header rule
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

% Titling (title/subtitle spacing)
\RequirePackage{titling}
\setlength{\droptitle}{-2cm}
\pretitle{\begin{center}\ImpactFont\fontsize{24}{28}\selectfont\bfseries}
% Print a \Large centered subtitle (if provided via \subtitle{...}) right under the title
\posttitle{\par\end{center}\vspace{-2em}%
  \ifx\subtitletext\@empty\else
    \begin{center}\large\subtitletext\end{center}\vskip 0.5em
  \fi
  \vspace{-4cm}}

% Section title formatting
\RequirePackage{titlesec}
\titleformat{\section}{\ImpactFont\fontsize{24}{28}\selectfont\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}{\ImpactFont\fontsize{18}{22}\selectfont\bfseries}{\thesubsection}{1em}{}

% Provide subtitle macro
\newcommand{\subtitle}[1]{\gdef\subtitletext{#1}}
\newcommand{\subtitletext}{}%

% Basic readability tweaks
\setlength{\parindent}{0pt}
\setlength{\parskip}{0.5\baselineskip}

% Build a ChoiceMenu from the comma-separated \centeroptions list.
% Usage: \ChoiceMenuFromList[<ChoiceMenu options>]{<list macro>}
% Example: \ChoiceMenuFromList[combo,name=myfield,width=5cm]{\centeroptions}
\ExplSyntaxOn
\cs_new_protected:Npn \jet_choice_menu:nn #1#2
 {
   \ChoiceMenu[#1]{}{#2}
 }
\cs_generate_variant:Nn \jet_choice_menu:nn {no}

\NewDocumentCommand\ChoiceMenuFromList{O{}m}
 { \jet_choice_menu:no {#1}{#2} }
\ExplSyntaxOff


% End of style.sty
